(this.webpackJsonpwebsite=this.webpackJsonpwebsite||[]).push([[0],{546:function(e,t,n){},547:function(e,t,n){},578:function(e){e.exports=JSON.parse('{"projectId":"myrandomwatch-b4b41","appId":"1:458223764382:web:ad550ac9d5d240982d0c8f","databaseURL":"https://myrandomwatch-b4b41-default-rtdb.firebaseio.com","storageBucket":"myrandomwatch-b4b41.appspot.com","locationId":"us-central","apiKey":"AIzaSyCfD31xo4THGYQ5_Y0-VPVT71T3sB2YxL0","authDomain":"myrandomwatch-b4b41.firebaseapp.com","messagingSenderId":"458223764382","measurementId":"G-F2BBYE9XWJ"}')},925:function(e,t,n){"use strict";n.r(t);var i,c=n(15),o=n(0),r=n.n(o),s=n(16),a=n.n(s),u=(n(546),n(41)),l=n(30),d=(n(547),n(289)),b=r.a.createContext(void 0),j=n(22),f=n(24),h=n(99),v=function(e,t,n,i){var c,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(c=e[s])&&(r=(o<3?c(r):o>3?c(t,n,r):c(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r},p=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},O=function e(){Object(j.a)(this,e)},g=i=function(){function e(){Object(j.a)(this,e),this.displayName=null}return Object(f.a)(e,[{key:"uid",value:function(){return this.id}},{key:"subscriptionAdd",value:function(e){this.subscriptions.create(e)}}],[{key:"fromFirebaseUser",value:function(e){var t=new i;return t.displayName=e.displayName,t.id=e.uid,t}}]),e}();v([Object(h.SubCollection)(O),p("design:type",Object)],g.prototype,"subscriptions",void 0),g=i=v([Object(h.Collection)()],g),n(575),n(576);var m=n(577).default,x=n(578);m.apps.length||m.initializeApp(x),h.initialize(m.firestore(),{validateModels:!0});var y=new(function(){function e(){Object(j.a)(this,e),this.currentUser=null}return Object(f.a)(e,[{key:"login",value:function(){var e=new m.auth.GoogleAuthProvider;m.auth().signInWithPopup(e).then((function(e){console.log(e.user)})).catch((function(e){console.log(e)}))}},{key:"logout",value:function(){this.currentUser=null,m.auth().signOut()}},{key:"userStatusChange",value:function(e){var t=this;m.auth().onAuthStateChanged((function(n){n?Object(h.getRepository)(g).findById(n.uid).then((function(i){if(i)t.currentUser=i,e(t.currentUser);else{var c=g.fromFirebaseUser(n);Object(h.getRepository)(g).create(c).then((function(n){t.currentUser=n,e(t.currentUser)}))}})):(console.log("user loggout!"),e(null))}))}},{key:"getCurrentUserOrNull",value:function(){return this.currentUser}},{key:"getCurrentUser",value:function(){return this.currentUser}}]),e}()),k=n(516),C=n.n(k),U=n(224),S=n(524),w=n(228);function R(e){var t=y.getCurrentUser(),n=w.a().shape({name:w.b().required(),url:w.b().url().required()}),i=Object(U.b)({resolver:Object(S.yupResolver)(n)}),o=i.register,r=i.handleSubmit,s=i.errors,a=i.reset,u=r((function(n){var i=n.name,c=n.url,o=e.sub||new O;o.name=i,o.url=c,e.sub?t.subscriptions.update(o).then((function(){console.log("done updating subscriptions"),e.callback&&e.callback()})):t.subscriptions.create(o).then((function(){console.log("done creating subscriptions"),e.callback&&e.callback(),a()}))})),l=e.sub;return Object(c.jsxs)("div",{children:[l?Object(c.jsx)("label",{children:"Update Subscription"},void 0):Object(c.jsx)("label",{children:"New Subscription"},void 0),Object(c.jsxs)("form",Object.assign({onSubmit:u},{children:[Object(c.jsx)("label",{children:"Name"},void 0),Object(c.jsx)("input",{name:"name",ref:o,defaultValue:l&&l.name},void 0),s.name&&"Name is required",Object(c.jsx)("label",{children:"URL"},void 0),Object(c.jsx)("input",{name:"url",ref:o,defaultValue:l&&l.url},void 0),s.url&&"URL must be valid",Object(c.jsx)("input",{type:"submit"},void 0)]}),void 0)]},void 0)}var I=function(e){var t={onRowsDelete:function(t){var n=y.getCurrentUser();t.data.map((function(t){var i=e.subs[t.dataIndex].id;n.subscriptions.delete(i).then((function(){console.log("deleted:"+i)}))}))},onRowClick:function(t,n){e.subClicked&&(console.log("row clicked"),e.subClicked(e.subs[n.dataIndex]))}};return Object(c.jsx)("div",Object.assign({style:{maxWidth:"100%"}},{children:Object(c.jsx)(C.a,{columns:[{label:"Name",name:"name"},{label:"URL",name:"url"}],data:e.subs,title:"Watch Subscriptions",options:t},void 0)}),void 0)},N=function(){var e=y.getCurrentUser(),t=r.a.useState(void 0),n=Object(u.a)(t,2),i=n[0],o=n[1],s=r.a.useState(void 0),a=Object(u.a)(s,2),l=a[0],d=a[1],b=r.a.useState(!1),j=Object(u.a)(b,2),f=j[0],h=j[1];return r.a.useEffect((function(){e.subscriptions.find().then((function(e){d(e)}))}),[f]),Object(c.jsxs)("div",{children:[Object(c.jsxs)("h1",{children:["AuthenticatedHome - ",e.displayName,", ",e.id]},void 0),Object(c.jsx)(R,{sub:i,callback:function(){console.log("hello"),o(void 0),h(!f)}},void 0),Object(c.jsx)(I,{subs:l,subClicked:function(e){console.log("upldated selected sub"),o(e)}},void 0)]},void 0)},A=function(){return Object(c.jsx)("h1",{children:" Oops! That page couldn't be found. "},void 0)},L=function(){var e=y.getCurrentUser();return Object(c.jsxs)("h1",{children:[" My Subscription for ",e.displayName,", ",e.id," "]},void 0)};function P(){return Object(c.jsxs)("div",{children:[Object(c.jsx)(T,{},void 0),Object(c.jsx)("p",Object.assign({onClick:function(e){y.logout()}},{children:"Logout"}),void 0)]},void 0)}function B(){return Object(c.jsxs)("h1",{children:[" Un-AuthenticatedApp xxx",Object(c.jsx)("p",Object.assign({onClick:function(e){console.log("clicked"),y.login()}},{children:"Sign in here"}),void 0)]},void 0)}function F(e){var t=r.a.useState(void 0),n=Object(u.a)(t,2),i=n[0],o=n[1];return r.a.useEffect((function(){y.userStatusChange((function(e){o(e)}))}),[]),void 0===i?Object(c.jsx)("h2",{children:" Loading"},void 0):i?Object(c.jsx)(b.Provider,Object.assign({value:i},{children:Object(c.jsx)(P,{},void 0)}),void 0):Object(c.jsx)(B,{},void 0)}var T=Object(l.g)((function(e){return e.location.search.startsWith("?/")?Object(c.jsx)(l.a,{to:e.location.search.slice(1)},void 0):Object(c.jsxs)(l.d,{children:[Object(c.jsx)(l.b,{exact:!0,path:"/",component:N},void 0),Object(c.jsx)(l.b,{exact:!0,path:"/sub",component:L},void 0),Object(c.jsx)(l.b,{exact:!0,path:"*",component:A},void 0)]},void 0)})),D=function(e){return Object(c.jsx)(d.a,{children:Object(c.jsx)("header",{children:Object(c.jsx)("div",Object.assign({className:"App"},{children:Object(c.jsx)(F,Object.assign({},e),void 0)}),void 0)},void 0)},void 0)},W=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,954)).then((function(t){var n=t.getCLS,i=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),i(e),c(e),o(e),r(e)}))};a.a.render(Object(c.jsx)(r.a.StrictMode,{children:Object(c.jsx)(D,{},void 0)},void 0),document.getElementById("root")),W()}},[[925,1,2]]]);
//# sourceMappingURL=main.a4a7aa89.chunk.js.map